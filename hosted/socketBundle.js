(()=>{var e={413:e=>{const t=e=>{console.log(e)};e.exports={handleError:t,sendPost:async(e,n,o)=>{const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await a.json();i.error&&t(i.error),i.redirect&&(window.location=i.redirect),o&&(console.log("calling handler",i),o(i))},sendPut:async(e,n,o)=>{const a=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await a.json();i.error&&t(i.error),i.redirect&&(window.location=i.redirect),o&&(console.log("calling handler"),console.log(i),o(i))},hideError:()=>{}}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}(()=>{const e=io(),t=n(413);let o=5,a=!0;const i=async e=>{e.preventDefault(),t.hideError();const n=document.getElementById("editbox"),o=await fetch("/getUsername"),i=await o.json(),r=await fetch("/getToken"),s=await r.json(),c=await fetch("/getProfile"),l=await c.json();l.profile&&(a=!l.profile[0].premium,console.log(l,a)),t.sendPost(e.target.action,{content:n.value,username:i.docs[0].username,_csrf:s.csrfToken}),n.value=""},r=e=>{const t=e.split(":"),n=document.createElement("div");n.innerHTML=`\n    <div class='box tile is-parent is-vertical notification is-info'>\n        <div class='is-child mb-3'>\n            ${t[0]}\n            \n        </div>\n        <div class='is-child has-background-light has-text-dark box'>\n            ${t[1]} \n        </div>\n    </div>\n    <br />\n    `,document.getElementById("messages").prepend(n),a&&(o--,o||((()=>{const e=document.createElement("div");e.innerHTML="    <div class='box tile is-parent is-vertical notification is-warning'>\n    <div class='is-child'>\n        <div class='has-background-light p-3 box'>\n            THIS IS AN AD\n        </div>\n    </div>\n    </div>\n    <br />\n",document.getElementById("messages").prepend(e)})(),o=5))},s=t=>React.createElement("form",{id:"editForm",onSubmit:i,action:"/createMessage",method:"POST"},React.createElement("textarea",{className:"textarea is-medium",id:"editbox",type:"text"}),React.createElement("br",null),React.createElement("div",{className:"is-flex is-flex-direction-row-reverse"},React.createElement("input",{className:"button is-medium ml-2",type:"submit"}),React.createElement("input",{id:"channelBox",type:"text",className:"input",onChange:t=>{return n=t.target.value,e.removeAllListeners(),console.log(n),void(n?e.on(n.toString(),r):e.on("global",r));var n},placeholder:"chat-room (leave empty for global)"})));window.addEventListener("load",(()=>{(async()=>{const t=await fetch("/getProfile");(await t.json()).profile[0]?.premium&&(a=!1),ReactDOM.render(React.createElement(s,null),document.getElementById("createMessage")),(()=>{const t=document.getElementById("editForm"),n=document.getElementById("editbox"),o=document.getElementById("channelBox");t.addEventListener("submit",(t=>{if(t.preventDefault(),n.value){const t={message:n.value,channel:o.value||"global"};e.emit("chat message",t)}}))})(),e.on("global",r),console.log("socket bundle")})()}))})()})();